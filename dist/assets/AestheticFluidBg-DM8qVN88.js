import{_ as $2,m as P2,o as R2,d as T2,a as z2}from"./index-ajJJZzak.js";function Y(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Y=function(n){return typeof n}:Y=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Y(t)}function m2(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var N2=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],G2=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function u2(t,n,g,s,c){if(typeof t=="string"&&(t=document.getElementById(t)),!t||Y(t)!=="object"||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var d=t.getContext("2d");try{return d.getImageData(n,g,s,c)}catch(e){throw new Error("unable to access image data: "+e)}}function H2(t,n,g,s,c,d){if(!(isNaN(d)||d<1)){d|=0;var e=u2(t,n,g,s,c);e=L2(e,n,g,s,c,d),t.getContext("2d").putImageData(e,n,g)}}function L2(t,n,g,s,c,d){for(var e=t.data,P=2*d+1,v=s-1,R=c-1,l=d+1,y=l*(l+1)/2,C=new D2,o=C,b,k=1;k<P;k++)o=o.next=new D2,k===l&&(b=o);o.next=C;for(var a=null,i=null,x=0,r=0,w=N2[d],B=G2[d],v2=0;v2<c;v2++){o=C;for(var j=e[r],I=e[r+1],p=e[r+2],O=e[r+3],y2=0;y2<l;y2++)o.r=j,o.g=I,o.b=p,o.a=O,o=o.next;for(var T=0,z=0,m=0,N=0,S=l*j,_=l*I,e2=l*p,t2=l*O,G=y*j,u=y*I,H=y*p,L=y*O,$=1;$<l;$++){var W=r+((v<$?v:$)<<2),x2=e[W],w2=e[W+1],B2=e[W+2],C2=e[W+3],q=l-$;G+=(o.r=x2)*q,u+=(o.g=w2)*q,H+=(o.b=B2)*q,L+=(o.a=C2)*q,T+=x2,z+=w2,m+=B2,N+=C2,o=o.next}a=C,i=b;for(var o2=0;o2<s;o2++){var r2=L*w>>>B;if(e[r+3]=r2,r2!==0){var a2=255/r2;e[r]=(G*w>>>B)*a2,e[r+1]=(u*w>>>B)*a2,e[r+2]=(H*w>>>B)*a2}else e[r]=e[r+1]=e[r+2]=0;G-=S,u-=_,H-=e2,L-=t2,S-=a.r,_-=a.g,e2-=a.b,t2-=a.a;var E=o2+d+1;E=x+(E<v?E:v)<<2,T+=a.r=e[E],z+=a.g=e[E+1],m+=a.b=e[E+2],N+=a.a=e[E+3],G+=T,u+=z,H+=m,L+=N,a=a.next;var V=i,b2=V.r,k2=V.g,E2=V.b,F2=V.a;S+=b2,_+=k2,e2+=E2,t2+=F2,T-=b2,z-=k2,m-=E2,N-=F2,i=i.next,r+=4}x+=s}for(var D=0;D<s;D++){r=D<<2;var F=e[r],M=e[r+1],A=e[r+2],f=e[r+3],n2=l*F,s2=l*M,l2=l*A,c2=l*f,J=y*F,K=y*M,Q=y*A,U=y*f;o=C;for(var M2=0;M2<l;M2++)o.r=F,o.g=M,o.b=A,o.a=f,o=o.next;for(var A2=s,i2=0,d2=0,f2=0,h2=0,Z=1;Z<=d;Z++){r=A2+D<<2;var X=l-Z;J+=(o.r=F=e[r])*X,K+=(o.g=M=e[r+1])*X,Q+=(o.b=A=e[r+2])*X,U+=(o.a=f=e[r+3])*X,h2+=F,i2+=M,d2+=A,f2+=f,o=o.next,Z<R&&(A2+=s)}r=D,a=C,i=b;for(var g2=0;g2<c;g2++){var h=r<<2;e[h+3]=f=U*w>>>B,f>0?(f=255/f,e[h]=(J*w>>>B)*f,e[h+1]=(K*w>>>B)*f,e[h+2]=(Q*w>>>B)*f):e[h]=e[h+1]=e[h+2]=0,J-=n2,K-=s2,Q-=l2,U-=c2,n2-=a.r,s2-=a.g,l2-=a.b,c2-=a.a,h=D+((h=g2+l)<R?h:R)*s<<2,J+=h2+=a.r=e[h],K+=i2+=a.g=e[h+1],Q+=d2+=a.b=e[h+2],U+=f2+=a.a=e[h+3],a=a.next,n2+=F=i.r,s2+=M=i.g,l2+=A=i.b,c2+=f=i.a,h2-=F,i2-=M,d2-=A,f2-=f,i=i.next,r+=s}}return t}var D2=function t(){m2(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};const W2={name:"Bg",props:{uploadedFile:{type:String,required:!1}},data(){return{colorbg:null,defaultColors:["#283c63","#928a97","#f85f73","#f85f73","#928a97"]}},mounted(){this.uploadedFile?this.updateBackground(this.uploadedFile):this.updateBackground(null);const t=()=>{this.colorbg&&(this.colorbg.destroy(),this.colorbg=null),this.updateBackground(this.uploadedFile||null)};window.addEventListener("resize",t),P2(()=>{window.removeEventListener("resize",t),this.colorbg&&this.colorbg.destroy()})},watch:{uploadedFile:{immediate:!0,handler(t){this.updateBackground(t||null)}}},methods:{async updateBackground(t){let n=this.defaultColors;try{t&&(n=await this.processImageWithBlur(t),console.log("提取的颜色：",n)),this.colorbg&&this.colorbg.destroy(),this.colorbg=new Color4Bg.AestheticFluidBg({dom:"box",colors:n,loop:!0,seed:Math.floor(Math.random()*1e4)})}catch(g){console.error("图片处理失败：",g),this.colorbg&&this.colorbg.destroy(),this.colorbg=new Color4Bg.AestheticFluidBg({dom:"box",colors:this.defaultColors,loop:!0,seed:Math.floor(Math.random()*1e4)})}},processImageWithBlur(t){return new Promise((n,g)=>{const s=new Image;s.crossOrigin="Anonymous",s.onload=()=>{const c=document.createElement("canvas"),d=c.getContext("2d");c.width=s.width,c.height=s.height,d.drawImage(s,0,0),H2(c,0,0,s.width,s.height,10);const e=document.createElement("canvas"),P=e.getContext("2d"),v=8;e.width=v,e.height=v,P.drawImage(c,0,0,v,v);const l=P.getImageData(0,0,v,v).data,o=((b,k,a)=>{const i=new Set;for(;i.size<b;){const x=Math.floor(Math.random()*k),r=Math.floor(Math.random()*a);i.add(`${x},${r}`)}return Array.from(i).map(x=>x.split(",").map(Number))})(5,e.width,e.height).map(([b,k])=>{const a=(k*v+b)*4,i=l[a],x=l[a+1],r=l[a+2];return this.rgbToHex(i,x,r)});n(o)},s.onerror=c=>g(c),s.src=t})},rgbToHex(t,n,g){return`#${((1<<24)+(t<<16)+(n<<8)+g).toString(16).slice(1)}`}}},q2={class:"absolute w-full h-full"};function V2(t,n,g,s,c,d){return R2(),T2("div",q2,n[0]||(n[0]=[z2("div",{id:"box",class:"absolute w-full h-full bg-gray-100"},null,-1)]))}const K2=$2(W2,[["render",V2]]);export{K2 as A};
